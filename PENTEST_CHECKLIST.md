# üîí Penetration Testing Checklist - Conta2Go

## Pre-Test Preparation

- [ ] Backup complete de la base de datos
- [ ] Ambiente de testing separado del producci√≥n
- [ ] Logs de auditor√≠a activados
- [ ] Monitoreo de recursos del servidor activo
- [ ] Plan de rollback documentado

---

## 1. Authentication & Session Management

### Login Security
- [ ] Probar SQL injection en campos de login
- [ ] Probar XSS en campos de usuario/contrase√±a
- [ ] Verificar rate limiting (max 5 intentos en 15 min)
- [ ] Probar bypass con credenciales por defecto
- [ ] Verificar que no hay informaci√≥n sensible en errores

### Session Management
- [ ] Verificar expiraci√≥n de sesi√≥n por inactividad (15 min)
- [ ] Probar session fixation attacks
- [ ] Verificar que tokens no se reutilizan
- [ ] Probar concurrent sessions desde diferentes IPs
- [ ] Verificar invalidaci√≥n de sesi√≥n al cambiar contrase√±a

### MFA
- [ ] Intentar bypass de MFA
- [ ] Probar brute force en c√≥digos TOTP
- [ ] Verificar backup codes con encriptaci√≥n
- [ ] Probar replay attacks con c√≥digos usados

### Password Policy
- [ ] Verificar complejidad m√≠nima (12+ chars)
- [ ] Probar contrase√±as comprometidas (HIBP)
- [ ] Verificar expiraci√≥n (90 d√≠as Admin/Contador)
- [ ] Verificar prevenci√≥n de reuso (√∫ltimas 5)
- [ ] Probar password reset flow

---

## 2. Authorization & Access Control

### RBAC
- [ ] Probar privilege escalation (Cliente ‚Üí Admin)
- [ ] Verificar aislamiento entre roles
- [ ] Probar acceso directo a URLs de admin
- [ ] Verificar permisos en API endpoints
- [ ] Probar IDOR (Insecure Direct Object Reference)

### API Endpoints
- [ ] Verificar autenticaci√≥n en todos los endpoints
- [ ] Probar access control en recursos
- [ ] Verificar validaci√≥n de par√°metros
- [ ] Probar mass assignment vulnerabilities
- [ ] Verificar respuestas no exponen data sensible

---

## 3. Input Validation & Injection

### SQL Injection
- [ ] Todos los campos de forms
- [ ]  Query parameters en URLs
- [ ] Headers HTTP
- [ ] File upload names
- [ ] JSON payloads en API

### XSS (Cross-Site Scripting)
- [ ] Stored XSS en campos de texto
- [ ] Reflected XSS en par√°metros
- [ ] DOM-based XSS
- [ ] XSS en file uploads
- [ ] XSS en error messages

### Command Injection
- [ ] File upload processing
- [ ] Export/Import features
- [ ] Report generation
- [ ] Email sending

### Other Injections
- [ ] LDAP injection
- [ ] XML injection  
- [ ] Template injection
- [ ] Server-Side Request Forgery (SSRF)

---

## 4. Cryptography

### Data at Rest
- [ ] Verificar encriptaci√≥n AES-256-GCM
- [ ] Probar acceso a datos encriptados sin clave
- [ ] Verificar rotaci√≥n de claves
- [ ] Probar cipher strength
- [ ] Verificar no hay datos sensibles en plain text

### Data in Transit
- [ ] Verificar HTTPS en todas las conexiones
- [ ] Probar downgrade attacks a HTTP
- [ ] Verificar TLS version (1.3)
- [ ] Probar SSL/TLS configuration (ssllabs.com)
- [ ] Verificar certificate pinning

### Sensitive Data Exposure
- [ ] Revisar logs no contienen passwords
- [ ] Verificar error messages no exponen info
- [ ] Revisar backups est√°n encriptados
- [ ] Verificar temporary files se eliminan
- [ ] Probar data leakage en responses

---

## 5. Business Logic

### Transacciones
- [ ] Probar negative amounts
- [ ] Verificar race conditions
- [ ] Probar double-spending
- [ ] Verificar atomic operations
- [ ] Probar boundary values

### File Upload
- [ ] Probar upload de malicious files
- [ ] Verificar file type validation
- [ ] Probar file size limits
- [ ] Verificar virus scanning
- [ ] Probar path traversal en filenames

### Rate Limiting
- [ ] Verificar l√≠mites en login
- [ ] Probar l√≠mites en API calls
- [ ] Verificar l√≠mites en export functions
- [ ] Probar bypass con m√∫ltiples IPs
- [ ] Verificar DDoS protection

---

## 6. Client-Side Security

### Browser Security
- [ ] Verificar CSP headers
- [ ] Probar X-Frame-Options
- [ ] Verificar X-Content-Type-Options
- [ ] Probar clickjacking
- [ ] Verificar CSRF tokens

### JavaScript Security
- [ ] Revisar dependencies vulnerables (npm audit)
- [ ] Verificar no hay secrets en client code
- [ ] Probar DOM manipulation  
- [ ] Verificar no hay sensitive data en localStorage
- [ ] Revisar console.log en producci√≥n

---

## 7. Infrastructure & Configuration

### Server Configuration
- [ ] Verificar no hay directory listing
- [ ] Probar acceso a .git, .env
- [ ] Verificar informaci√≥n en headers revelada
- [ ] Probar default credentials
- [ ] Verificar unnecessary services disabled

### Database Security
- [ ] Verificar least privilege access
- [ ] Probar direct database access
- [ ] Verificar backup encryption
- [ ] Probar SQL injection via ORM
- [ ] Verificar connection strings seguras

### Third-Party Services
- [ ] Revisar Supabase security settings
- [ ] Verificar Prisma queries seguras
- [ ] Revisar API keys rotation
- [ ] Verificar third-party dependencies
- [ ] Probar service misconfigurations

---

## 8. Monitoring & Logging

### Audit Logs
- [ ] Verificar todos los eventos cr√≠ticos se loguean
- [ ] Probar log tampering
- [ ] Verificar logs no contienen PII
- [ ] Verificar timestamp integrity
- [ ] Probar log injection

### Alerting
- [ ] Verificar alertas de seguridad funcionan
- [ ] Probar detection de actividad sospechosa
- [ ] Verificar alertas de m√∫ltiples login fails
- [ ] Probar alertas de privilege escalation
- [ ] Verificar notification delivery

---

## 9. Mobile & API Security

### API Security
- [ ] Verificar API versioning
- [ ] Probar API rate limiting
- [ ] Verificar API authentication
- [ ] Probar API parameter pollution
- [ ] Verificar API error handling

### REST Best Practices
- [ ] Verificar m√©todos HTTP apropiados
- [ ] Probar OPTIONS, HEAD, TRACE
- [ ] Verificar status codes correctos
- [ ] Probar CORS configuration
- [ ] Verificar pagination security

---

## 10. Compliance & Privacy

### GDPR / Privacy
- [ ] Verificar data minimization
- [ ] Probar derecho al olvido
- [ ] Verificar consentimiento expl√≠cito
- [ ] Probar data portability
- [ ] Verificar breach notification process

### Data Retention
- [ ] Verificar pol√≠ticas de retenci√≥n
- [ ] Probar purge de data antigua
- [ ] Verificar archival seguro
- [ ] Probar data recovery procedures
- [ ] Verificar compliance reporting

---

## Tools Recomendadas

### Automated Scanners
- [ ] OWASP ZAP
- [ ] Burp Suite Community
- [ ] Nikto
- [ ] SQLMap
- [ ] Nmap

### Manual Testing
- [ ] Postman/Insomnia (API testing)
- [ ] Browser DevTools
- [ ] curl/wget
- [ ] Wireshark (network analysis)

### Code Analysis
- [ ] Snyk
- [ ] SonarQube
- [ ] npm audit
- [ ] ESLint security plugins

---

## Post-Test Actions

- [ ] Documentar todas las vulnerabilidades encontradas
- [ ] Clasificar por severidad (Critical, High, Medium, Low)
- [ ] Crear tickets para remediation
- [ ] Re-test despu√©s de fixes
- [ ] Actualizar documentaci√≥n de seguridad
- [ ] Compartir findings con el equipo
- [ ] Planificar pr√≥ximo pentest (cada 3-6 meses)

---

## Severity Classification

**Critical:** Acceso no autorizado a sistema, data breach, RCE  
**High:** Privilege escalation, XSS stored, SQL injection  
**Medium:** XSS reflected, CSRF, information disclosure  
**Low:** Versi√≥n revelada, warnings menores

---

**√öltima actualizaci√≥n:** Sprint 4 - Hardening y Testing  
**Responsable:** Security Team  
**Pr√≥ximo Test:** [Fecha]
